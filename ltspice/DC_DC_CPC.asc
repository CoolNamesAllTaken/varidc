Version 4
SHEET 1 1660 1604
WIRE 112 160 -192 160
WIRE 320 160 112 160
WIRE 768 160 688 160
WIRE 912 160 832 160
WIRE 976 160 912 160
WIRE 1136 160 1056 160
WIRE 1264 160 1136 160
WIRE 112 208 112 160
WIRE 176 224 160 224
WIRE 320 224 320 160
WIRE 176 272 160 272
WIRE 912 272 912 160
WIRE 1136 272 1136 160
WIRE 1264 272 1264 160
WIRE 176 288 176 272
WIRE 112 320 112 288
WIRE 400 320 112 320
WIRE 448 320 400 320
WIRE 400 336 400 320
WIRE 448 352 448 320
WIRE 480 352 448 352
WIRE 688 352 688 160
WIRE 688 352 656 352
WIRE 480 384 448 384
WIRE 688 384 656 384
WIRE -192 416 -192 160
WIRE 320 432 320 288
WIRE 400 432 400 416
WIRE 400 432 320 432
WIRE 448 432 448 384
WIRE 448 432 400 432
WIRE 688 448 688 384
WIRE 912 448 912 336
WIRE 912 448 688 448
WIRE 1136 448 1136 336
WIRE 1136 448 912 448
WIRE 1264 448 1264 352
WIRE 1264 448 1136 448
WIRE 688 464 688 448
WIRE 112 496 112 320
WIRE 320 496 320 432
WIRE 384 512 368 512
WIRE 384 560 368 560
WIRE 384 576 384 560
WIRE -192 624 -192 496
WIRE 112 624 112 560
WIRE 112 624 -192 624
WIRE 320 624 320 576
WIRE 320 624 112 624
WIRE -192 640 -192 624
WIRE 128 816 -32 816
WIRE 256 816 224 816
WIRE -32 848 -32 816
WIRE 448 848 448 832
WIRE -32 944 -32 928
WIRE 448 944 448 928
WIRE -448 1104 -448 1088
WIRE -32 1104 -32 1088
WIRE -448 1200 -448 1184
WIRE -32 1200 -32 1184
WIRE -48 1344 -464 1344
WIRE 96 1344 48 1344
WIRE -464 1376 -464 1344
WIRE -288 1392 -352 1392
WIRE -48 1392 -288 1392
WIRE -352 1408 -352 1392
WIRE -464 1472 -464 1456
WIRE -352 1504 -352 1488
FLAG 176 288 0
FLAG 384 576 0
FLAG 176 224 q
FLAG 384 512 q
FLAG -192 640 0
FLAG 688 464 0
FLAG -448 1200 0
FLAG -448 1088 v_sawtooth
FLAG 1264 160 v_o
FLAG -32 816 v_err
FLAG -32 944 0
FLAG 256 816 i_c
FLAG 448 944 0
FLAG 448 832 i_slope
FLAG -32 1200 0
FLAG -32 1088 m_a
FLAG -352 1504 0
FLAG -464 1472 0
FLAG -288 1392 v_comp
FLAG 96 1344 q
SYMBOL voltage -192 400 R0
SYMATTR InstName V1
SYMATTR Value {V_g}
SYMBOL sw 112 304 R180
SYMATTR InstName Q2
SYMATTR Value SW_ideal
SYMBOL sw 320 592 R180
SYMATTR InstName Q1
SYMATTR Value SW_ideal
SYMBOL diode 128 560 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMATTR Value D_ideal
SYMBOL diode 336 288 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value D_ideal
SYMBOL transformer 560 368 R0
WINDOW 39 3 -49 Left 2
SYMATTR SpiceLine n={1/n}
SYMATTR InstName X1
SYMBOL diode 768 176 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value D_ideal
SYMBOL diode 928 336 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMATTR Value D_ideal
SYMBOL ind 960 176 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L_o
SYMATTR Value {L_o}
SYMBOL ind 384 320 R0
WINDOW 0 -51 29 Left 2
WINDOW 3 -83 72 Left 2
SYMATTR InstName L_m
SYMATTR Value {L_m}
SYMBOL res 1248 256 R0
SYMATTR InstName R_L
SYMATTR Value {R_L}
SYMBOL voltage -448 1088 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 0 0 {T} 0 {T})
SYMBOL bv -32 832 R0
SYMATTR InstName B1
SYMATTR Value V={V_ref}-V(v_o)
SYMBOL PID 176 816 R0
WINDOW 39 30 37 Center 2
SYMATTR SpiceLine Kp=0.0005025 Ki=0.75 Kd=0
SYMATTR InstName U1
SYMBOL bv 448 832 R0
SYMATTR InstName B3
SYMATTR Value V=V(i_c)-V(m_a)*V(v_sawtooth)
SYMBOL bv -32 1088 R0
SYMATTR InstName B2
SYMATTR Value V=V(v_o)/{L_o}
SYMBOL bv -352 1392 R0
WINDOW 3 46 60 Left 2
SYMATTR Value V=if(I(Q1) < V(i_c), 0, 1)
SYMATTR InstName B4
SYMBOL voltage -464 1360 R0
WINDOW 0 -107 -2 Left 2
WINDOW 3 -313 54 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_CLK
SYMATTR Value PULSE(0 1 0 0 0 1n {T})
SYMBOL Digital\\srflop 0 1296 R0
SYMATTR InstName A1
SYMBOL cap 1120 272 R0
SYMATTR InstName C_o
SYMATTR Value {C_o}
TEXT 264 64 Left 2 !.param V_g=400 D=0.3 f_s=100k T=1/{f_s} L_m=10m n=3 R_L=100 L_o=50m V_ref=20 m_a={V_ref/L_o} C_o=33u
TEXT -240 -280 Left 2 !.model D_ideal D(Ron=1m)
TEXT -240 -256 Left 2 !.model SW_ideal SW(Ron=1m Roff=1G Vt=0.5)
TEXT 632 -264 Left 2 !.tran 0 20m 0m 1u
TEXT 632 -240 Left 2 !.OPTIONS RELTOL=0.01 VNTOL = 0.01 ABSTOL = 0.01
